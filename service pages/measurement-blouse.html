<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Take Measurements | MODASOU</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <!-- Note: If app.js causes errors, our script below is designed to ignore them -->
    <script src="assets/js/app.js"></script>

    <style>
        :root {
            --chocolate: #4b2e1f;
            --dark-brown: #2b1a12;
            --golden: #d4af37;
            --light-golden: #f5e6b0;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #331300;
            color: #fffdf7;
        }

        /* NAVBAR */
        .navbar {
            background: #fff;
            border-bottom: 2px solid var(--light-golden);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-wrap {
            max-width: 1200px;
            margin: auto;
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 26px;
            font-weight: 700;
            color: var(--golden);
            text-decoration: none;
            letter-spacing: 1px;
        }

        .menu a {
            margin: 0 14px;
            text-decoration: none;
            color: var(--dark-brown);
            font-weight: 500;
        }

        /* HEADER */
        .header {
            padding: 40px 20px;
            text-align: center;
            border-bottom: 2px solid var(--light-golden);
        }

        .header h1 { color: var(--golden); margin-bottom: 10px; }
        .header p { color: #f5e6b0; }

        /* MEASUREMENT GUIDE */
        .measurement-guides {
            max-width: 850px;
            margin: 40px auto;
            padding: 20px;
            background: #fffdf7;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .measurement-guides img {
            display: block;
            width: 100%;
            margin-bottom: 30px;
            border-radius: 12px;
            border: 2px solid #d4af37;
        }

        /* FORM SECTION */
        .measurement-input-section {
        
            width: 90%;
            max-width: 800px;
            margin: 40px auto;
            padding: 30px;
            background: #f5e6b0;
            border-radius: 20px;
            color: #331300;
        }

        .measurement-input-section h2 {
            text-align: center;
            margin-bottom: 30px;
        }

        

        .input-wrap input {
            width: 80px;
            padding: 10px;
            border: none;
            text-align: center;
            font-size: 16px;
        }

        .input-wrap span {
            background: #d4af37;
            padding: 10px;
            color: #fff;
            font-weight: bold;
        }

        .submit-btn, .nextBtn {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 20px auto;
            padding: 18px;
            border-radius: 40px;
            border: none;
            font-size: 22px;
            font-weight: bold;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            transition: 0.3s;
        }

        .nextBtn { background: #d4af37; color: #331300; }
        .submit-btn { background: #4b2e1f; color: #fff; }
        
        .nextBtn:hover { background: #4b2e1f; color: #fff; }
        .submit-btn:disabled { background: #999; cursor: not-allowed; }

        footer {
            text-align: center;
            padding: 2rem;
            background: #d4af37;
            color: #331300;
            margin-top: 50px;
        }
        /* This was causing the horizontal stretch */
.options-wrapper {
  display: block; /* Changed from grid to block for vertical flow */
  width: 100%; 
}

/* This ensures the form inside the card flows downwards */
.measurement-form {
  display: flex;
  flex-direction: column; /* Force vertical stack */
  gap: 15px;
  padding: 10px;
}

/* This makes each row take up the full width */
.measure-row {
  display: flex;
  justify-content: space-between; /* Label on left, Input on right */
  align-items: center;
  width: 100%;
  border-bottom: 1px solid rgba(0,0,0,0.05); /* Optional: adds a thin line between rows */
  padding-bottom: 10px;
}

.measure-row label {
  flex: 1;
  font-size: 18px;
  color: #331300;
  padding-right: 15px;
}

.input-wrap {
    
  flex-shrink: 0; /* Prevents the input from squishing */
  display: flex;
  align-items: center;
  border: 2px solid #d4af37;
  border-radius: 12px;
  background: #fff;
}

        @media (max-width: 600px) {
            .measure-row { flex-direction: column; align-items: flex-start; }
            .input-wrap { width: 100%; margin-top: 5px; }
            .input-wrap input { flex: 1; }
            .nav-wrap {
                flex-direction: column;
                gap: 10px;
            }
            .menu {
                display: flex;
                gap: 10px;
            }
        }
    </style>
</head>

<body>

<header class="navbar">
    <div class="nav-wrap">
        <a href="index.html" class="logo">MODASOU</a>
        <nav class="menu">
            <a href="/index.html">Home</a>
        </nav>
    </div>
</header>

<div class="header">
    <h1>Tops Measurement Guide</h1>
    <p>Please enter your measurements in inches as per the guide images.</p>
</div>

<div class="container">
    <div class="measurement-guides">
    

    <img src="/measureblouseimages/1.jpg" alt="Measurement Guide Image1">
     <img src="/measureblouseimages/2.jpg" alt="Measurement Guide Image2">
  <img src="/measureblouseimages/3.jpg" alt="Measurement Guide Image3">
       <img src="/measureblouseimages/4.jpg" alt="Measurement Guide Image4s">

        <!-- Add more images as needed -->
    </div>

    <section class="measurement-input-section">
        <h2>Enter Your Measurements</h2>
        
        <!-- FIXED FORM NESTING -->
        <form id="measurementForm">

            <div class="measure-row">
      <label>1-Front length of the blouse:</label>
      <div class="input-wrap">
      <input type="number" name="Front-length-of-the-blouse" step="0.1" placeholder="0" >
        <span>in</span>
      </div></div>
      
    <div class="measure-row">
      <label>2-Back length of the blouse:</label>
      <div class="input-wrap">
        <input type="number" name="Back-length-of-the-blouse" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>

    <div class="measure-row">
      <label>3-Mid-point to apex length:</label>
      <div class="input-wrap">
        <input type="number" name="Mid-point_to-apex-length" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>

    <div class="measure-row">
      <label>4-Mid-point to under-bust length:</label>
      <div class="input-wrap">
        <input type="number" name=" Mid-point_to_under-bust_length" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>

    <div class="measure-row">
      <label>5-Across shoulder:</label>
      <div class="input-wrap">
        <input type="number" name="Across_shoulder" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
      <div class="measure-row">
      <label>6-Bust round:</label>
      <div class="input-wrap">
        <input type="number" name="bust_round" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>7-Waist round:</label>
      <div class="input-wrap">
        <input type="number" name="waist_round" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>8-Apex point to point:</label>
      <div class="input-wrap">
        <input type="number" name="apex-point-to-point" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>9-Front neck depth:</label>
      <div class="input-wrap">
        <input type="number" name="front-neck-depth" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>10-Back neck depth:</label>
      <div class="input-wrap">
        <input type="number" name="back-neck-depth" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>11-Armhole:</label>
      <div class="input-wrap">
        <input type="number" name="Armhole" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>12-Short sleeve length:</label>
      <div class="input-wrap">
        <input type="number" name="short-sleeve-length" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>13-Short sleeve round:</label>
      <div class="input-wrap">
        <input type="number" name="short-sleeve-round" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>14-Elbow sleeve length:</label>
      <div class="input-wrap">
        <input type="number" name="elbowSleeveLength" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>15-Elbow sleeve round:</label>
      <div class="input-wrap">
        <input type="number" name="elbowSleeveRound" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>16-Full sleeve Length:</label>
      <div class="input-wrap">
        <input type="number" name="fullSleeveLength" step="0.1" placeholder="0" >
        <span>in</span>
      </div>
    </div>
    <div class="measure-row">
      <label>17-Full sleeve round:</label>
      <div class="input-wrap">
        <input type="number" name="fullSleeveRound" step="0.1" placeholder="0" >
        <span>in</span>
      </div></div>
    
                    <
            <!-- Add all other 17 fields here following the same structure -->

            <button id="saveBtn" type="button" class="nextBtn">
                Submit Measurements
            </button>
        </form>
    </section>

    <!-- We changed href to "#" and added id="nextBtn" -->
<a href="#" id="nextBtn" class="submit-btn">Go to Final Step</a>
</div>

<footer>
    <p>© 2025 MODASOU - LUXURY, CUSTOMIZED</p>
</footer>

<script>
/**
 * Using an IIFE (Immediately Invoked Function Expression) to protect our code 
 * from SyntaxErrors occurring in other files like app.js
 */
(function() {
    const URL = "https://gztneesmxwfhdmhqikel.supabase.co";
    const KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd6dG5lZXNteHdmaGRtaHFpa2VsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxNjAzNDAsImV4cCI6MjA4MjczNjM0MH0.iWDtkljuQLZFQeLvBrJHVyXNfpu4bJOvvVab3G0eOsA";

    // Renamed client to avoid "Already Declared" errors
    const modasouClient = window.supabase.createClient(URL, KEY);

    // Renamed session variable to avoid conflicts
    let modasouSession = localStorage.getItem('modasou_session_id');
    if (!modasouSession) {
        modasouSession = "SESS_" + Date.now();
        localStorage.setItem('modasou_session_id', modasouSession);
    }

    const btn = document.getElementById("saveBtn");
    const form = document.getElementById("measurementForm");

    if (btn) {
        btn.addEventListener("click", async () => {
            console.log("Submit clicked. Data processing...");
            
            btn.innerText = "Saving data...";
            btn.disabled = true;

            const formData = new FormData(form);
            const dataObj = {};

            formData.forEach((value, key) => {
                dataObj[key] = (value.trim() === "") ? null : parseFloat(value);
            });
            // <--- ADD THESE LINES ---
localStorage.setItem("measurements", JSON.stringify(dataObj));
localStorage.setItem("selectedService", "Blouse"); 
// ------------------------

            console.log("Data to be sent:", dataObj);

            try {
                const { error } = await modasouClient
                    .from("orders")
                    .upsert({
                        session_id: modasouSession,
                        service: "tops", // Updated service name
                        blouse_measurements: dataObj, // Keeping column name as per your DB
                        created_at: new Date().toISOString()
                    }, { onConflict: "session_id" });

                if (error) throw error;

                alert("✅ Progress Saved! You can now click 'Go to Final Step'.");
                btn.innerText = "SAVED SUCCESSFULLY ✓";
                btn.style.background = "#28a745"; // Green
                btn.disabled = false;

            } catch (err) {
                console.error("Supabase Submission Error:", err);
                alert("❌ Database Error: " + err.message);
                btn.innerText = "Try Submitting Again";
                btn.disabled = false;
            }
        });
    } else {
        console.error("Button with ID 'saveBtn' not found!");
    }
})();
</script>


<script>
  const nextButton = document.getElementById("nextBtn");

  if (nextButton) {
    nextButton.addEventListener("click", function(e) {
      e.preventDefault();

      // Get the current flag
      const userFlow = localStorage.getItem("active_service");
      
      // DEBUG: Log what the browser sees in the Console (F12)
      console.log("Current User Flow Value:", userFlow);

      // LOGIC
      if (userFlow === "service2") {
        console.log("Redirecting to Service 2 Submission...");
        window.location.href = "/service2submission.html";
      } else {
        // If userFlow is "service1" OR null OR anything else -> Go here
        console.log("Redirecting to Standard Final Form...");
        window.location.href = "/final-submit.html";
      }
    });
  }
</script></body></html>