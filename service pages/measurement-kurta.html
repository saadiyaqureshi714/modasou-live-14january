<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>How to Take Measurements | MODASOU</title>
<!-- Supabase Library -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
/* CSS KEPT EXACTLY THE SAME */
:root{ --chocolate:#4b2e1f; --dark-brown:#2b1a12; --golden:#d4af37; --light-golden:#f5e6b0; }
.navbar{ background:#fff; border-bottom:2px solid var(--light-golden); position:sticky; top:0; z-index:1000; }
.nav-wrap{ max-width:1200px; margin:auto; padding:15px 25px; display:flex; justify-content:space-between; align-items:center; }
.logo{ font-size:26px; font-weight:700; color:var(--golden); text-decoration:none; letter-spacing:1px; }
.menu a{ margin:0 14px; text-decoration:none; color:var(--dark-brown); font-weight:500; position:relative; padding-bottom:5px; }
body{ margin:0; font-family: 'Segoe UI', sans-serif; background:#331300; color:#fffdf7; }
.header{ padding:20px; text-align:center; border-bottom:2px solid var(--light-golden); }
.header h1{ color:var(--golden); margin-bottom:5px; }
.container{ max-width:1100px; margin:auto; padding:30px 20px; }
.guide{ text-align:center; margin-bottom:40px; }
.measurement-guides { max-width: 850px; margin: 40px auto; padding: 20px; background: #fffdf7; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
.measurement-guides img { display: block; width: 100%; height: auto; margin-bottom: 30px; border-radius: 12px; border: 2px solid #d4af37; }
.measurement-input-section { width: 80%; padding: 30px; background: #f5e6b0; border-radius: 20px; margin: auto; }
.measurement-input-section h2 { text-align: center; color: #331300; margin-bottom: 30px; font-size: 30px; font-family: 'poppins', sans-serif; }
.measurement-form { display: flex; flex-direction: column; gap: 20px; padding: 0 30px; }
.measure-row { display: flex; justify-content: space-between; align-items: center; gap: 15px; }
.measure-row label { font-weight: 600; color: #2b1a12; font-size: 20px; flex: 1; }
.input-wrap { display: flex; align-items: center; border: 2px solid #d4af37; border-radius: 12px; overflow: hidden; background: #fff; }
.input-wrap input { width: 100px; padding: 10px; border: none; outline: none; font-size: 16px; text-align: center; }
.input-wrap span { background: #f5e6b0; padding: 10px 14px; font-weight: 600; color: #4b2e1f; }
.note{ margin-top: 40px; text-align: center; color: #fffdf7; font-size: 18px; }

.submit-btn { width: 20%; text-decoration: none; display: block; text-align:center; color: #331300;
              margin: 25px auto 0; padding: 20px 60px; background: #d4af37; border: none;
               border-radius: 30px; font-size: 26px; cursor: pointer; }
.submit-btn:hover{
  background: #f5e6b0;
  
}
.nextBtn {  text-decoration: none; display: block; text-align:center; color: #331300; 
          margin: 25px auto 0; padding: 20px 60px; background: #d4af37; border: none; 
          border-radius: 30px; font-size: 26px; cursor: pointer;}
.nextBtn:hover{
  background: #f5e6b0;
}
footer { text-align: center; padding: 2rem 1rem; background-color: #d4af37; color: #f5e6b8; font-size: 0.9rem; margin-top: 50px;}
#p{ font-family: 'CINZEL', serif; }
@media (max-width: 600px) { 
  .measure-row { flex-direction: column; align-items: flex-start; } 
  .measurement-input-section { width: 95%; padding: 15px; }
  .nav-wrap { flex-direction: column; gap: 10px; }
  .menu { display: flex; gap: 10px; }
}
</style>
</head>

<body>

<header class="navbar">
  <div class="nav-wrap">
    <a href="index.html" class="logo">MODASOU</a>
    <nav class="menu">
      <a href="/index.html">Home</a>
    </nav>
  </div>
</header>

<div class="header">
  <h1>How to Take Your Measurements Of Your Kurti</h1>
  <p>Follow the guide below and choose a convenient method</p>
</div>

<div class="container">
  <div class="guide">
    <h2>Measurement Guide</h2>
    <div class="measurement-guides">
      <img src="/size kurti/1.jpg" alt="1">
      <img src="/size kurti/2.jpg" alt="2">
      <img src="/size kurti/3.jpg" alt="3">
      <img src="/size kurti/4.jpg" alt="4">
      <img src="/size kurti/5.jpg" alt="5">
      <img src="/size kurti/6.jpg" alt="6">
    </div>
  </div>

  <section class="measurement-section">
    <div class="measurement-input-section">
      <h2>Enter Your Measurements (in Inches)</h2>
      <!-- All 'required' removed as requested -->
      <form id="kurtaForm">
        <div class="measurement-form">
          <div class="measure-row"><label>1-Bust round:</label><div class="input-wrap"><input type="number" name="bust_round" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>2-Waist round:</label><div class="input-wrap"><input type="number" name="waist_round" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>3-Hip round:</label><div class="input-wrap"><input type="number" name="hip_round" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>4-Nape to bust length:</label><div class="input-wrap"><input type="number" name="nape_to_bust" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>5-Nape to waist length:</label><div class="input-wrap"><input type="number" name="nape_to_waist" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>6-Nape to hip length:</label><div class="input-wrap"><input type="number" name="nape_to_hip" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>7-Across shoulder:</label><div class="input-wrap"><input type="number" name="across_shoulder" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>8-Across chest:</label><div class="input-wrap"><input type="number" name="across_chest" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>9-Armhole:</label><div class="input-wrap"><input type="number" name="armhole" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>10-Short sleeve length:</label><div class="input-wrap"><input type="number" name="short_sleeve_len" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>11-Short sleeve round:</label><div class="input-wrap"><input type="number" name="short_sleeve_round" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>12-Elbow sleeve length:</label><div class="input-wrap"><input type="number" name="elbow_sleeve_len" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>13-Elbow sleeve round:</label><div class="input-wrap"><input type="number" name="elbow_sleeve_round" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>14-Full sleeve length:</label><div class="input-wrap"><input type="number" name="full_sleeve_len" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>15-Full sleeve round:</label><div class="input-wrap"><input type="number" name="full_sleeve_round" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>16-Kurta length:</label><div class="input-wrap"><input type="number" name="kurta_length" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>17-Front neck depth:</label><div class="input-wrap"><input type="number" name="front_neck" step="0.1" placeholder="0"><span>in</span></div></div>
          <div class="measure-row"><label>18-Back neck depth:</label><div class="input-wrap"><input type="number" name="back_neck" step="0.1" placeholder="0"><span>in</span></div></div>
        </div>
      </form>
    </div>

    <p class="note">Your measurements are safe with us. Our team will contact you after submission.</p>

    <!-- BACKEND SUBMIT BUTTON -->
    <button id="backendSubmitBtn" class="nextBtn">
      Submit Measurements
    </button>
    
    <!-- NEXT PAGE BUTTON -->
   
    
<a href="#" id="nextBtn" class="submit-btn">Go to Final Step</a>
  </section>
</div>

<footer>
  <p id="p">© 2025 MODASOU - LUXURY, CUSTOMIZED</p>
</footer>



<script>
(function() {
    // Initialize Supabase
    const SUPABASE_URL = "https://gztneesmxwfhdmhqikel.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd6dG5lZXNteHdmaGRtaHFpa2VsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcxNjAzNDAsImV4cCI6MjA4MjczNjM0MH0.iWDtkljuQLZFQeLvBrJHVyXNfpu4bJOvvVab3G0eOsA";
    
    // Using a unique client variable to be safe
    const kurtaClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // 1. SESSION ID: Updated to match Blouse/Dress logic
    let modasouSession = localStorage.getItem('modasou_session_id');
    if (!modasouSession) {
        modasouSession = 'SESS_' + Date.now();
        localStorage.setItem('modasou_session_id', modasouSession);
    }

    const btn = document.getElementById("backendSubmitBtn");

    if (btn) {
        btn.addEventListener("click", async () => {
            console.log("Processing Kurta submission...");
            btn.innerText = "Saving...";
            btn.disabled = true;

            const form = document.getElementById("kurtaForm");
            const formData = new FormData(form);
            const measurementsData = {};

            // Convert form data to numbers where possible
            formData.forEach((value, key) => {
                measurementsData[key] = (value.trim() === "") ? null : parseFloat(value);
            });

            // =======================================================
            // 2. LINK TO FINAL FORM (EMAIL)
            // =======================================================
            localStorage.setItem("measurements", JSON.stringify(measurementsData));
            localStorage.setItem("selectedService", "Kurta");
            // =======================================================

            try {
                // 3. SAVE TO DATABASE (Orders Table)
                const { error } = await kurtaClient
                    .from("orders")
                    .upsert({
                        session_id: modasouSession,
                        service: "kurta", 
                        
                        // Saves to the new column you created in Step 1
                        kurta_measurements: measurementsData, 
                        
                        created_at: new Date().toISOString()
                    }, { onConflict: "session_id" });

                if (error) throw error;

                alert("✅ Kurta measurements saved successfully!");
                btn.innerText = "SUBMITTED ✓";
                btn.style.background = "#28a745";
                btn.disabled = false;

            } catch (err) {
                console.error("Supabase Error:", err);
                alert("❌ Error saving: " + err.message);
                btn.innerText = "Submit Measurements";
                btn.disabled = false;
            }
        });
    } else {
        console.error("Button 'backendSubmitBtn' not found!");
    }
})();
</script>


<script>
  const nextButton = document.getElementById("nextBtn");

  if (nextButton) {
    nextButton.addEventListener("click", function(e) {
      e.preventDefault();

      // Get the current flag
      const userFlow = localStorage.getItem("active_service");
      
      // DEBUG: Log what the browser sees in the Console (F12)
      console.log("Current User Flow Value:", userFlow);

      // LOGIC
      if (userFlow === "service2") {
        console.log("Redirecting to Service 2 Submission...");
        window.location.href = "/service2submission.html";
      } else {
        // If userFlow is "service1" OR null OR anything else -> Go here
        console.log("Redirecting to Standard Final Form...");
        window.location.href = "/final-submit.html";
      }
    });
  }
</script></body></html>
